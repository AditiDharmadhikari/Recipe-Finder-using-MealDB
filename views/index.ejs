<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Recipe Finder WebApp</title>
</head>
<body class="d-flex flex-column min-vh-100">
    
   <%- include("partials/header.ejs") %>
   <main class="flex-grow-1">
    <div class="container">
        <h4>Search Meal by Name</h4>
        <form action="/search" method="POST" class="input-group mb-3">
        <input type="text" name="search_food" class="form-control" placeholder="e.g. Cake">
        <button class="btn btn-outline-primary" type="submit">Search</button>
        </form>

        <!-- Search by First Letter -->
        <h4>Search Meal by First Letter</h4>
        <form action="/search-letter" method="POST" class="input-group mb-3">
        <input type="text" name="letter" maxlength="1" class="form-control" placeholder="e.g. A">
        <button class="btn btn-outline-secondary" type="submit">Search</button>
        </form>


        <!-- Explore Options -->
       <div class="container mt-4">
        <div class="row g-0">
            <div class="col-12">
            <div class="btn-group d-flex w-100 explore-group" role="group" aria-label="Explore Meals">
                <a href="/categories" class="btn explore-btn categories flex-fill">Categories</a>
                <a href="/areas" class="btn explore-btn areas flex-fill">Areas</a>
                <a href="/ingredients" class="btn explore-btn ingredients flex-fill">Ingredients</a>
                <a href="/random-meal" class="btn explore-btn random flex-fill">Random Meal</a>
            </div>
            </div>
        </div>
        </div>

    </div>

    <div>
         <% if (locals.categories && categories.length > 0) { %>
            <% categories.forEach(category => { %>
                <div class="container">
                    <div class="category">
                        <img src="<%= category.strCategoryThumb %>" alt="<%= category.strCategory %>">
                        <div>
                            <h3>
                                <a href="/filter?c=<%= category.strCategory %>" class="text-decoration-none">
                                    <%= category.strCategory %>
                                </a>
                            </h3>

                            <p><%= category.strCategoryDescription.substring(0, 150) %>...</p>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } %>

        <% if (locals.areas && areas.length > 0) { %>
            <div class="container">
                <div class="mt-5">
                    <h4 class="mb-4">Explore by Cuisine</h4>
                    <div class="row">
                        <% areas.forEach(area => { %>
                            <div class="col-md-4 mb-3">
                                <div class="card shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">
                                            üåç <a href="/filter?a=<%= area.strArea %>" class="text-decoration-none">
                                                <%= area.strArea %>
                                            </a>
                                        </h5>

                                        <p class="card-text">
                                            Discover delicious recipes from the <strong><%= area.strArea %></strong> cuisine.
                                            Click on this cuisine elsewhere to view related meals.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                </div>
            </div>
        <% } %>

        <% if (locals.ingredients && ingredients.length > 0) { %>
            <div class="container">
                <div class="mt-5">
                    <h4 class="mb-4">Explore by Ingredients</h4>
                    <div class="row">
                        <% ingredients.forEach(ingredient => { %>
                            <div class="col-md-4 mb-3">
                                <div class="card shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">
                                            ü•Ñ <a href="/filter?i=<%= ingredient.strIngredient %>" class="text-decoration-none">
                                                <%= ingredient.strIngredient %>
                                            </a>
                                        </h5>

                                        <p class="card-text">
                                            <%= ingredient.strDescription 
                                                    ? ingredient.strDescription.substring(0, 100) + "..." 
                                                    : "No description available." %>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    </div>

                    <!-- Pagination Controls -->
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center mt-4">
                            <% if (currentPage > 1) { %>
                                <li class="page-item">
                                    <a class="page-link" href="/ingredients?page=<%= currentPage - 1 %>">Previous</a>
                                </li>
                            <% } %>

                            <% for (let i = 1; i <= totalPages; i++) { %>
                                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                                    <a class="page-link" href="/ingredients?page=<%= i %>"><%= i %></a>
                                </li>
                            <% } %>

                            <% if (currentPage < totalPages) { %>
                                <li class="page-item">
                                    <a class="page-link" href="/ingredients?page=<%= currentPage + 1 %>">Next</a>
                                </li>
                            <% } %>
                        </ul>
                    </nav>
                </div>
            </div>
        <% } %>



    </div>
    </main>
    


    <%- include("partials/footer.ejs") %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</body>
</html>